<root>
    <in>
        position4f
        normal
    </in>
    <out>FragColor</out>
    <uniform>
        PhongLight light;
        PhongMaterial phong;
        WorldMatrix fs_world;
    </uniform>

    <main>
        //ambient
        vec3    ambient     =phong.ambient*light.color;

        //diffuse
        vec3    light_dir   =normalize(light.position-Position.xyz);
        float   diff        =max(dot(Normal,light_dir),0.0);
        vec3    diffuse     =diff*light.color;

        //specular
        vec3    view_dir    =normalize(fs_world.view_pos-Position.xyz);
        vec3    reflect_dir =reflect(-light_dir,Normal);
        float   spec        =pow(max(dot(view_dir,reflect_dir),0.0),32);
        vec3    specular    =phong.specular*spec*light.color;

        FragColor=vec4((ambient+diffuse+specular),1.0)*phong.BaseColor;
    </main>
</root>

